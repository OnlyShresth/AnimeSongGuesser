<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>AnimeSongGuesser - Working UI Switch</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: linear-gradient(135deg, #14213d 0%, #000000 100%);
      color: white;
      margin: 0;
      padding: 20px;
      min-height: 100vh;
    }

    .container {
      max-width: 1000px;
      margin: 0 auto;
    }

    /* SIMPLE SECTIONS WITH CLEAR VISIBILITY CONTROL */
    .section {
      display: block;
      margin: 20px 0;
      padding: 30px;
      background: rgba(255, 255, 255, 0.1);
      border-radius: 10px;
      border: 2px solid #fca311;
    }

    .section.hidden {
      display: none !important;
    }

    .menu-item {
      background: rgba(252, 163, 17, 0.2);
      border: 2px solid #fca311;
      border-radius: 10px;
      padding: 30px;
      margin: 20px 0;
      cursor: pointer;
      text-align: center;
      font-size: 1.2em;
    }

    .menu-item:hover {
      background: rgba(252, 163, 17, 0.4);
    }

    .btn {
      background: #fca311;
      color: #14213d;
      border: none;
      padding: 15px 30px;
      border-radius: 25px;
      cursor: pointer;
      font-size: 1.1em;
      font-weight: bold;
      margin: 10px;
    }

    .btn:hover {
      background: #ffb347;
      transform: scale(1.05);
    }

    .game-controls {
      display: flex;
      justify-content: center;
      align-items: center;
      gap: 30px;
      margin: 30px 0;
      flex-wrap: wrap;
    }

    .play-btn {
      width: 80px;
      height: 80px;
      border-radius: 50%;
      background: #fca311;
      border: none;
      color: #14213d;
      font-size: 2em;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .timer {
      font-size: 3em;
      font-weight: bold;
      color: #fca311;
    }

    .guess-input {
      width: 100%;
      padding: 15px;
      font-size: 1.2em;
      border-radius: 25px;
      border: 2px solid #fca311;
      background: rgba(0, 0, 0, 0.3);
      color: white;
      text-align: center;
    }

    .messages {
      height: 200px;
      overflow-y: auto;
      background: rgba(0, 0, 0, 0.3);
      border: 1px solid #fca311;
      border-radius: 10px;
      padding: 15px;
      margin: 20px 0;
    }

    .message {
      margin: 10px 0;
      padding: 10px;
      border-radius: 5px;
      background: rgba(252, 163, 17, 0.2);
    }

    .status-display {
      position: fixed;
      top: 10px;
      right: 10px;
      background: rgba(0, 0, 0, 0.8);
      padding: 10px;
      border-radius: 5px;
      font-family: monospace;
      font-size: 12px;
      max-width: 300px;
    }
  </style>
</head>
<body>
  <!-- STATUS DISPLAY FOR DEBUGGING -->
  <div class="status-display" id="statusDisplay">
    Status: Initializing...
  </div>

  <div class="container">
    <h1 style="text-align: center; color: #fca311; font-size: 3em; margin-bottom: 30px;">
      üéµ AnimeSongGuesser
    </h1>

    <!-- MAIN MENU SECTION -->
    <div class="section" id="mainMenuSection">
      <h2 style="text-align: center; color: #fca311;">Main Menu</h2>
      
      <div class="section" style="text-align: center;">
        <h3>Choose Your Name</h3>
        <input type="text" id="playerName" placeholder="Enter your name..." 
               style="padding: 10px; font-size: 1.1em; border-radius: 20px; border: 1px solid #fca311; background: rgba(0,0,0,0.3); color: white; text-align: center;">
      </div>

      <div class="menu-item" id="practiceBtn">
        <h3>üéØ Practice Mode</h3>
        <p>Practice solo to test your anime music knowledge</p>
      </div>
    </div>

    <!-- GAME INTERFACE SECTION -->
    <div class="section hidden" id="gameInterfaceSection">
      <h2 style="text-align: center; color: #fca311;">Game In Progress</h2>
      
      <div style="text-align: center; margin: 20px 0;">
        <h3>Song <span id="currentSong">1</span> of 10</h3>
        <p>Score: <span id="scoreDisplay">0</span> points</p>
      </div>

      <div class="game-controls">
        <button class="play-btn" id="playBtn">‚ñ∂Ô∏è</button>
        <div class="timer" id="timer">5</div>
        <button class="btn" id="extendBtn">‚è∞ Extend (+5s, -5pts)</button>
      </div>

      <div style="margin: 30px 0;">
        <h3>Make Your Guess:</h3>
        <input type="text" class="guess-input" id="guessInput" 
               placeholder="Song title, anime name, or artist...">
      </div>

      <div class="messages" id="messages">
        <div class="message">üéµ Game started! Click play to begin...</div>
      </div>

      <div style="text-align: center;">
        <button class="btn" id="backToMenuBtn">üè† Back to Menu</button>
      </div>

      <!-- HIDDEN AUDIO ELEMENT -->
      <audio id="audioPlayer" style="display: none;"></audio>
    </div>
  </div>

  <script>
    console.log('üéµ Script starting...');

    // SIMPLE GLOBAL VARIABLES
    let gameState = {
      playerName: 'Anonymous',
      currentSong: 1,
      totalSongs: 10,
      score: 0,
      timer: 5,
      isPlaying: false,
      hasExtended: false,
      songs: [],
      currentTimerInterval: null,
      audioController: null
    };

    // STATUS UPDATE FUNCTION FOR DEBUGGING
    function updateStatus(message) {
      console.log('üìä Status:', message);
      const statusEl = document.getElementById('statusDisplay');
      if (statusEl) {
        statusEl.innerHTML = `Status: ${message}<br>Current Song: ${gameState.currentSong}<br>Score: ${gameState.score}<br>Playing: ${gameState.isPlaying}`;
      }
    }

    // DEMO SONGS
    function createDemoSongs() {
      return [
        { title: "Cruel Angel's Thesis", anime: "Neon Genesis Evangelion", artist: "Yoko Takahashi" },
        { title: "Tank!", anime: "Cowboy Bebop", artist: "The Seatbelts" },
        { title: "Unravel", anime: "Tokyo Ghoul", artist: "TK from Ling tosite sigure" },
        { title: "Gurenge", anime: "Demon Slayer", artist: "LiSA" },
        { title: "We Are!", anime: "One Piece", artist: "Hiroshi Kitadani" },
        { title: "Again", anime: "Fullmetal Alchemist", artist: "YUI" },
        { title: "Silhouette", anime: "Naruto Shippuden", artist: "KANA-BOON" },
        { title: "My War", anime: "Attack on Titan", artist: "Shinsei Kamattechan" },
        { title: "Racing into the Night", anime: "YOASOBI", artist: "YOASOBI" },
        { title: "Renai Circulation", anime: "Bakemonogatari", artist: "Kana Hanazawa" }
      ];
    }

    // SIMPLE UI SWITCHING FUNCTIONS
    function showMainMenu() {
      console.log('üè† Showing main menu');
      updateStatus('Showing main menu');
      
      const mainMenu = document.getElementById('mainMenuSection');
      const gameInterface = document.getElementById('gameInterfaceSection');
      
      if (mainMenu) {
        mainMenu.classList.remove('hidden');
        console.log('‚úÖ Main menu shown');
      }
      
      if (gameInterface) {
        gameInterface.classList.add('hidden');
        console.log('‚úÖ Game interface hidden');
      }
    }

    function showGameInterface() {
      console.log('üéÆ Showing game interface');
      updateStatus('Showing game interface');
      
      const mainMenu = document.getElementById('mainMenuSection');
      const gameInterface = document.getElementById('gameInterfaceSection');
      
      if (mainMenu) {
        mainMenu.classList.add('hidden');
        console.log('‚úÖ Main menu hidden');
      }
      
      if (gameInterface) {
        gameInterface.classList.remove('hidden');
        console.log('‚úÖ Game interface shown');
      }
      
      // Update displays
      updateGameDisplay();
    }

    function updateGameDisplay() {
      const songEl = document.getElementById('currentSong');
      if (songEl) songEl.textContent = gameState.currentSong;
      
      const scoreEl = document.getElementById('scoreDisplay');
      if (scoreEl) scoreEl.textContent = gameState.score;
      
      const timerEl = document.getElementById('timer');
      if (timerEl) timerEl.textContent = gameState.timer;
    }

    // MESSAGE SYSTEM
    function addMessage(text, type = '') {
      console.log(`üí¨ Message: ${text}`);
      
      const messagesContainer = document.getElementById('messages');
      if (!messagesContainer) return;
      
      const messageDiv = document.createElement('div');
      messageDiv.className = 'message';
      messageDiv.textContent = text;
      
      if (type === 'correct') messageDiv.style.background = 'rgba(76, 175, 80, 0.3)';
      if (type === 'wrong') messageDiv.style.background = 'rgba(244, 67, 54, 0.3)';
      
      messagesContainer.appendChild(messageDiv);
      messagesContainer.scrollTop = messagesContainer.scrollHeight;
      
      // Keep only last 10 messages
      const messages = messagesContainer.children;
      if (messages.length > 10) {
        messages[0].remove();
      }
    }

    // GAME FUNCTIONS
    function setPlayerName() {
      const nameInput = document.getElementById('playerName');
      if (nameInput && nameInput.value.trim()) {
        gameState.playerName = nameInput.value.trim();
      }
      console.log('üë§ Player name:', gameState.playerName);
      updateStatus(`Player: ${gameState.playerName}`);
    }

    function startPracticeMode() {
      console.log('üéØ Starting practice mode...');
      updateStatus('Starting practice mode');
      
      setPlayerName();
      gameState.songs = createDemoSongs();
      gameState.currentSong = 1;
      gameState.score = 0;
      gameState.timer = 5;
      gameState.isPlaying = false;
      
      // SWITCH TO GAME INTERFACE
      showGameInterface();
      startNewSong();
      
      addMessage(`üéµ Welcome ${gameState.playerName}! Round 1 starting...`);
    }

    function startNewSong() {
      console.log(`üéµ Starting song ${gameState.currentSong}`);
      updateStatus(`Round ${gameState.currentSong}`);
      
      if (gameState.currentSong > gameState.totalSongs) {
        endGame();
        return;
      }
      
      // Reset round
      gameState.timer = 5;
      gameState.hasExtended = false;
      gameState.isPlaying = false;
      
      // Clear timer
      if (gameState.currentTimerInterval) {
        clearInterval(gameState.currentTimerInterval);
        gameState.currentTimerInterval = null;
      }
      
      // Update display
      updateGameDisplay();
      
      const playBtn = document.getElementById('playBtn');
      if (playBtn) playBtn.textContent = '‚ñ∂Ô∏è';
      
      const guessInput = document.getElementById('guessInput');
      if (guessInput) {
        guessInput.value = '';
        guessInput.focus();
      }
      
      const song = gameState.songs[gameState.currentSong - 1];
      addMessage(`üéµ Round ${gameState.currentSong}: Click play to hear the song!`);
      
      console.log(`Current song: ${song.title} from ${song.anime}`);
    }

    function toggleAudio() {
      console.log('üîä Toggle audio');
      
      const playBtn = document.getElementById('playBtn');
      if (!playBtn) return;
      
      if (gameState.isPlaying) {
        // Stop playing
        gameState.isPlaying = false;
        playBtn.textContent = '‚ñ∂Ô∏è';
        
        if (gameState.currentTimerInterval) {
          clearInterval(gameState.currentTimerInterval);
          gameState.currentTimerInterval = null;
        }
        
        addMessage('‚è∏Ô∏è Audio paused');
        updateStatus('Audio paused');
      } else {
        // Start playing
        gameState.isPlaying = true;
        playBtn.textContent = '‚è∏Ô∏è';
        
        addMessage('‚ñ∂Ô∏è Audio playing! Make your guess...');
        updateStatus('Audio playing');
        
        startTimer();
      }
    }

    function startTimer() {
      console.log('‚è±Ô∏è Starting timer');
      
      if (gameState.currentTimerInterval) {
        clearInterval(gameState.currentTimerInterval);
      }
      
      gameState.currentTimerInterval = setInterval(() => {
        gameState.timer--;
        
        const timerEl = document.getElementById('timer');
        if (timerEl) timerEl.textContent = gameState.timer;
        
        updateStatus(`Timer: ${gameState.timer}`);
        
        if (gameState.timer <= 0) {
          clearInterval(gameState.currentTimerInterval);
          gameState.currentTimerInterval = null;
          timeUp();
        }
      }, 1000);
    }

    function makeGuess() {
      const guessInput = document.getElementById('guessInput');
      if (!guessInput) return;
      
      const guess = guessInput.value.trim();
      if (!guess) return;
      
      console.log(`ü§î Guess: ${guess}`);
      
      const currentSong = gameState.songs[gameState.currentSong - 1];
      const isCorrect = checkGuess(guess, currentSong);
      
      if (isCorrect) {
        const points = gameState.hasExtended ? 5 : 10;
        gameState.score += points;
        
        addMessage(`‚úÖ "${guess}" - CORRECT! +${points} points`, 'correct');
        addMessage(`üéµ "${currentSong.title}" from ${currentSong.anime}`);
        
        // Stop game
        gameState.isPlaying = false;
        if (gameState.currentTimerInterval) {
          clearInterval(gameState.currentTimerInterval);
          gameState.currentTimerInterval = null;
        }
        
        updateGameDisplay();
        updateStatus(`Correct! Score: ${gameState.score}`);
        
        setTimeout(() => {
          nextSong();
        }, 3000);
      } else {
        addMessage(`‚ùå "${guess}" - Try again!`, 'wrong');
      }
      
      guessInput.value = '';
      guessInput.focus();
    }

    function checkGuess(guess, song) {
      const targets = [song.title, song.anime, song.artist];
      const guessLower = guess.toLowerCase();
      
      return targets.some(target => {
        const targetLower = target.toLowerCase();
        return targetLower.includes(guessLower) || guessLower.includes(targetLower);
      });
    }

    function timeUp() {
      console.log('‚è∞ Time up!');
      
      gameState.isPlaying = false;
      const playBtn = document.getElementById('playBtn');
      if (playBtn) playBtn.textContent = '‚ñ∂Ô∏è';
      
      const currentSong = gameState.songs[gameState.currentSong - 1];
      addMessage('‚è∞ Time\'s up!');
      addMessage(`üéµ Answer: "${currentSong.title}" from ${currentSong.anime}`);
      
      setTimeout(() => {
        nextSong();
      }, 4000);
    }

    function nextSong() {
      gameState.currentSong++;
      startNewSong();
    }

    function endGame() {
      console.log('üèÅ Game ended');
      
      const finalScore = gameState.score;
      const maxScore = gameState.totalSongs * 10;
      const accuracy = (finalScore / maxScore * 100).toFixed(1);
      
      addMessage('üéâ GAME COMPLETE!');
      addMessage(`üèÜ Final Score: ${finalScore}/${maxScore} points`);
      addMessage(`üìä Accuracy: ${accuracy}%`);
      
      updateStatus(`Game ended: ${finalScore}/${maxScore}`);
      
      setTimeout(() => {
        if (confirm(`Game Complete!\nScore: ${finalScore}/${maxScore}\nPlay again?`)) {
          startPracticeMode();
        } else {
          showMainMenu();
        }
      }, 3000);
    }

    function extendTime() {
      if (!gameState.hasExtended && gameState.isPlaying) {
        gameState.timer += 5;
        gameState.hasExtended = true;
        gameState.score = Math.max(0, gameState.score - 5);
        
        updateGameDisplay();
        addMessage('‚è∞ Time extended! (-5 points)');
      }
    }

    function backToMenu() {
      console.log('üè† Back to menu');
      
      // Stop everything
      gameState.isPlaying = false;
      if (gameState.currentTimerInterval) {
        clearInterval(gameState.currentTimerInterval);
        gameState.currentTimerInterval = null;
      }
      
      // Reset state
      gameState.currentSong = 1;
      gameState.score = 0;
      gameState.timer = 5;
      
      showMainMenu();
    }

    // EVENT LISTENERS
    window.onload = function() {
      console.log('üöÄ Window loaded');
      updateStatus('Initializing');
      
      // Initialize audio controller
      gameState.audioController = document.getElementById('audioPlayer');
      
      // Practice button
      const practiceBtn = document.getElementById('practiceBtn');
      if (practiceBtn) {
        practiceBtn.onclick = function() {
          console.log('‚úÖ Practice clicked!');
          startPracticeMode();
        };
      }
      
      // Play button
      const playBtn = document.getElementById('playBtn');
      if (playBtn) {
        playBtn.onclick = function() {
          console.log('‚úÖ Play clicked!');
          toggleAudio();
        };
      }
      
      // Extend button
      const extendBtn = document.getElementById('extendBtn');
      if (extendBtn) {
        extendBtn.onclick = function() {
          console.log('‚úÖ Extend clicked!');
          extendTime();
        };
      }
      
      // Back to menu button
      const backBtn = document.getElementById('backToMenuBtn');
      if (backBtn) {
        backBtn.onclick = function() {
          console.log('‚úÖ Back clicked!');
          backToMenu();
        };
      }
      
      // Guess input
      const guessInput = document.getElementById('guessInput');
      if (guessInput) {
        guessInput.onkeypress = function(e) {
          if (e.key === 'Enter') {
            makeGuess();
          }
        };
      }
      
      // Name input
      const nameInput = document.getElementById('playerName');
      if (nameInput) {
        nameInput.onkeypress = function(e) {
          if (e.key === 'Enter') {
            setPlayerName();
          }
        };
      }
      
      updateStatus('Ready');
      console.log('‚úÖ All event listeners attached');
      console.log('üéØ Try clicking Practice Mode!');
    };

    console.log('üìã Script loaded');
  </script>
</body>
</html>
